(self.webpackChunkpz_frontend=self.webpackChunkpz_frontend||[]).push([[9766],{47300:(t,e,s)=>{"use strict";s.d(e,{Z:()=>l});var a=s(6610),r=s(5991),n=s(65255),i=s(53724),o=s(77608);var l=function(t){(0,n.Z)(u,t);var e,s,l=(e=u,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,a=(0,o.Z)(e);if(s){var r=(0,o.Z)(this).constructor;t=Reflect.construct(a,arguments,r)}else t=a.apply(this,arguments);return(0,i.Z)(this,t)});function u(){return(0,a.Z)(this,u),l.apply(this,arguments)}return(0,r.Z)(u,[{key:"resource",value:function(){return"user"}}]),u}(s(33686).Z)},48649:(t,e,s)=>{"use strict";s.d(e,{Z:()=>r});const a={name:"UiSelectValidation",props:{rules:{type:String,default:""},items:{type:Array,default:""},value:{type:null},disabled:{type:Boolean,default:!1}},data:function(){return{selectValue:0}},computed:{lowerCaseLabel:function(){return this.$attrs.label?this.$attrs.label.toLowerCase().trim():""}},watch:{selectValue:function(t){this.$emit("input",t)},value:function(t){if("number"==typeof t){var e=this.getItem(t);if(e)return void(this.selectValue={id:e.id,name:e.name})}this.selectValue=t}},methods:{getItem:function(t){return this.items.find((function(e){return e.id===t}))}},created:function(){if("number"==typeof this.value){var t=this.getItem(this.value);if(t)return void(this.selectValue={id:t.id,name:t.name})}else this.value&&(this.selectValue=this.value)}},r=(0,s(51900).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ValidationProvider",{attrs:{name:t.lowerCaseLabel},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("v-select",{attrs:{hint:""+t.selectValue.name,items:t.items,"item-text":"name","item-value":"id",label:t.$attrs.label,"error-messages":a,disabled:t.disabled,"persistent-hint":"","return-object":""},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}})]}}])})}),[],!1,null,null,null).exports},61113:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});const a=(0,s(51900).Z)({name:"ConfirmModal",props:{value:{type:null}},data:function(){return{showModal:""}},watch:{showModal:function(t){this.$emit("input",t)},value:function(t){this.showModal=t}},created:function(){this.value&&(this.showModal=this.value)},methods:{close:function(){this.showModal=!1,this.$emit("onclose",!0)}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-center"},[s("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[t._t("header")],2),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.close}},[t._v(t._s(t.$t("buttons.actions.close")))]),t._v(" "),t._t("actions"),t._v(" "),s("v-spacer")],2)],1)],1)],1)}),[],!1,null,null,null).exports},58958:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});const a=(0,s(51900).Z)({name:"FormModal",props:{value:{type:null}},data:function(){return{showModal:""}},watch:{showModal:function(t){this.$emit("input",t)},value:function(t){this.showModal=t}},created:function(){this.value&&(this.showModal=this.value)},methods:{close:function(){this.showModal=!1,this.$emit("onclose",!0)}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[t._t("header")],2),t._v(" "),s("v-card-text",[s("form",[s("v-card",{staticClass:"mb-5 elevation-0"},[s("v-container",[s("v-row",[t._t("body")],2)],1)],1)],1)]),t._v(" "),s("v-card-actions",[s("v-spacer"),t._v(" "),s("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.close}},[t._v(t._s(t.$t("buttons.actions.close")))]),t._v(" "),t._t("actions"),t._v(" "),s("v-spacer")],2)],1)],1)}),[],!1,null,null,null).exports},22561:(t,e,s)=>{"use strict";s.d(e,{Z:()=>r});const a={name:"UIPagination",props:{length:{type:Number,default:15},totalVisible:{type:Number,default:7},value:{type:null}},data:function(){return{currentPage:1}},watch:{currentPage:function(t){this.$emit("input",t)},value:function(t){this.currentPage=t}},created:function(){this.value&&(this.currentPage=this.value)}},r=(0,s(51900).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-center"},[s("v-pagination",{attrs:{length:t.length,"total-visible":t.totalVisible},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)}),[],!1,null,null,null).exports},29766:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>x});var a=s(92137),r=s(87757),n=s.n(r),i=s(54726),o=s(48649),l=s(22561),u=s(61113),c=s(58958),d=s(43960),f=(s(47300),s(6610)),h=s(5991),v=s(65255),p=s(53724),m=s(77608);var g=function(t){(0,v.Z)(r,t);var e,s,a=(e=r,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,a=(0,m.Z)(e);if(s){var r=(0,m.Z)(this).constructor;t=Reflect.construct(a,arguments,r)}else t=a.apply(this,arguments);return(0,p.Z)(this,t)});function r(){return(0,f.Z)(this,r),a.apply(this,arguments)}return(0,h.Z)(r,[{key:"resource",value:function(){return"usergroup"}},{key:"delete",value:function(){if(this._customResource)throw Error("The delete() method cannot be used in conjunction with the custom() method. Use for() instead.");var t=Object.assign({},this);return delete t.id,this.request(this._reqConfig({method:"DELETE",url:this.endpoint(),data:t})).then((function(t){return t}))}}]),r}(s(33686).Z);const _={ititle:"users.list.title",components:{UiInputTextValidation:i.Z,UiSelectValidation:o.Z,UIPagination:l.Z,ConfirmModal:u.Z,FormModal:c.Z,SearchUserDialog:d.Z},data:function(){return{pageId:1,allPages:0,dialogAdd:!1,dialogDelete:!1,dialogAddUser:!1,headers:[{text:this.$t("forms.fields.user.id"),align:"start",value:"id"},{text:this.$t("forms.fields.user.email"),value:"email"},{text:this.$t("forms.fields.user.firstname"),value:"firstname"},{text:this.$t("forms.fields.user.surname"),value:"surname"},{text:this.$t("general.actions"),value:"actions",sortable:!1}],data:[],rolesData:[],editedIndex:-1,newItem:{id:0,email:"",password:"",firstname:"",surname:"",sex:{id:0,name:"Kobieta"},active:{id:1,name:"Aktywny"},roles:[{id:0,name:""}]},defaultItem:{id:0,email:"",password:"",firstname:"",surname:"",sex:{id:0,name:"Kobieta"},active:{id:1,name:"Aktywny"},roles:[{id:0,name:""}]},loading:!0}},computed:{userFullName:{get:function(){if(this.editedIndex>=0){var t=this.data[this.editedIndex];if(t)return t.firstname+" "+t.surname}return""},set:function(t){return t}}},mounted:function(){var t=this;this.$nextTick((function(){t.pageId=parseInt(t.$route.params.pageId),t.groupId=parseInt(t.$route.params.groupId),t.fetchUsersData()}))},methods:{fetchUsersData:function(){var t=arguments,e=this;return(0,a.Z)(n().mark((function s(){var a,r,i,o;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:null,r=e,e.loading=!0,s.prev=3,a&&a(),s.next=7,g.custom("/group_users/".concat(r.groupId)).page(r.pageId).get();case 7:i=s.sent,o=i.data,r.allPages=r.getAllPagesFromLast(i.last_page),o&&(r.data=o),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(3),r.$toast.error(r.$t("users.list.error"),r.$t("notifications.error"));case 16:return s.prev=16,r.loading=!1,s.finish(16);case 19:case"end":return s.stop()}}),s,null,[[3,13,16,19]])})))()},saveUserData:function(t){var e=arguments,s=this;return(0,a.Z)(n().mark((function a(){var r,i,o,l;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.length>1&&void 0!==e[1]?e[1]:null,i=s,a.prev=2,o=new g(t),a.next=6,o.save();case 6:if("User doesnt exist"!=(l=a.sent).msg){a.next=10;break}return i.$toast.error(i.$t("users.general.noExist"),i.$t("notifications.error")),a.abrupt("return");case 10:if("Group doesnt exist"!=l.msg){a.next=13;break}return i.$toast.error(i.$t("groups.general.noExist"),i.$t("notifications.error")),a.abrupt("return");case 13:if("User already has this group"!=l.msg){a.next=16;break}return i.$toast.error(i.$t("groups.users.hasGroup"),i.$t("notifications.error")),a.abrupt("return");case 16:i.$toast.success(i.$t("groups.users.assign.success"),i.$t("notifications.success")),i.fetchUsersData(r),a.next=23;break;case 20:a.prev=20,a.t0=a.catch(2),i.$toast.error(i.$t("users.add.error"),i.$t("notifications.error"));case 23:case"end":return a.stop()}}),a,null,[[2,20]])})))()},deleteUserData:function(t){var e=arguments,s=this;return(0,a.Z)(n().mark((function a(){var r,i,o;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.length>1&&void 0!==e[1]?e[1]:null,i=s,a.prev=2,o=new g({group_id:i.groupId,user_id:t}),a.next=6,o.delete();case 6:i.$toast.success(i.$t("groups.users.delete.success"),i.$t("notifications.success")),i.fetchUsersData(r),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(2),i.$toast.error(i.$t("users.delete.error"),i.$t("notifications.error"));case 13:case"end":return a.stop()}}),a,null,[[2,10]])})))()},addUser:function(t){this.saveUserData({group_id:this.groupId,user_id:t.id})},openAddUserDialog:function(){this.dialogAddUser=!0},openDeleteUserDialog:function(t){this.editedIndex=this.data.indexOf(t),this.editedItem=this._.cloneDeep(t),this.dialogDelete=!0},deleteUserConfirm:function(){var t=this.data[this.editedIndex];this.deleteUserData(t.id),this.closeUserDeleteDialog()},closeUserDeleteDialog:function(){this.dialogDelete=!1}},watch:{pageId:function(t){this.fetchUsersData()},groupId:function(t){this.fetchUsersData()}}},x=(0,s(51900).Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("PageBar",[t.$can("save","Users")?s("v-btn",{staticClass:"primary",attrs:{elevation:"1",large:"",rounded:"",loading:t.loading},on:{click:t.openAddUserDialog}},[s("v-icon",{staticClass:"mr-3",attrs:{color:"white"}},[t._v("fas fa-plus")]),t._v("\n\t\t\t"+t._s(t.$t("users.add.title"))+"\n\t\t")],1):t._e()],1),t._v(" "),s("v-container",{attrs:{fluid:"",tag:"section"}},[s("v-row",[s("v-col",{attrs:{cols:"12",lg:"12"}},[s("v-card",{staticClass:"mx-auto"},[s("v-card-text",[s("div",{staticClass:"text--primary"},[[s("v-data-table",{attrs:{headers:t.headers,items:t.data,"disable-pagination":!0,"footer-props":{disablePagination:!0,disableItemsPerPage:!0},"hide-default-footer":!0,"loading-text":"",loading:t.loading},scopedSlots:t._u([{key:"item.actions",fn:function(e){var a=e.item;return[s("router-link",{attrs:{to:{name:"UsersGet",params:{userId:a.id}}}},[t.$can("read","Users")?s("v-icon",{attrs:{small:"",disabled:t.loading},on:{click:function(e){return t.showProfile(a)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\tfas fa-search-plus\n\t\t\t\t\t\t\t\t\t\t\t")]):t._e()],1),t._v(" "),t.$can("delete","Users")?s("v-icon",{attrs:{small:"",disabled:t.loading},on:{click:function(e){return t.openDeleteUserDialog(a)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\tfas fa-trash\n\t\t\t\t\t\t\t\t\t\t")]):t._e()]}},{key:"no-data",fn:function(){return[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(t.$t("data.noResults"))+"\n\t\t\t\t\t\t\t\t\t")]},proxy:!0}])},[[s("v-progress-linear",{staticClass:"ma-0",attrs:{slot:"progress",color:"blue",indeterminate:"",height:"4"},slot:"progress"})]],2)]],2)])],1),t._v(" "),s("UIPagination",{staticClass:"mt-4",attrs:{length:t.allPages},model:{value:t.pageId,callback:function(e){t.pageId=e},expression:"pageId"}})],1)],1)],1),t._v(" "),s("SearchUserDialog",{on:{selected:t.addUser},scopedSlots:t._u([{key:"header",fn:function(){return[t._v("\n\t\t\t"+t._s(t.$t("groups.users.assign.title"))+"\n\t\t")]},proxy:!0}]),model:{value:t.dialogAddUser,callback:function(e){t.dialogAddUser=e},expression:"dialogAddUser"}}),t._v(" "),s("ConfirmModal",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v(t._s(t.$t("users.delete.confTitle"))+" "+t._s(t.userFullName)+"?")]},proxy:!0},{key:"actions",fn:function(){return[s("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.deleteUserConfirm}},[t._v(t._s(t.$t("buttons.actions.accept")))])]},proxy:!0}]),model:{value:t.dialogDelete,callback:function(e){t.dialogDelete=e},expression:"dialogDelete"}})],1)}),[],!1,null,null,null).exports}}]);